# 研修課題5：支出管理アプリ開発

## 📋 課題概要

**AIを活用しながら、Webアプリ開発からデータ連携までを一貫して体験する総合課題**

### 目的
- 仕様の明文化とAI活用スキルの習得
- フロントエンド開発の実践
- GAS（Google Apps Script）によるデータ連携
- GitHubを使ったバージョン管理

### テーマ
**支出管理アプリ**
日付・カテゴリ・金額を入力すると一覧表示され、ブラウザ（localStorage）とGoogleスプレッドシート両方に保存される。

---

## 🎯 学習フロー（全5フェーズ）

| フェーズ | 使用ツール | 目的 | 成果物 |
|---------|-----------|------|--------|
| ① 仕様書作成 | Claude Code | 要件定義・AI壁打ち | 仕様書.md |
| ② リポジトリ作成 | GitHub | バージョン管理 | リポジトリ |
| ③ フロント開発 | Claude Code | Webアプリ実装 | HTML/CSS/JS |
| ④ GAS連携 | GAS + Sheets | データ保存・集計 | main.gs |
| ⑤ 提出 | GitHub | 成果物の提出 | 完成版一式 |

---

## 📝 フェーズ1：仕様書作成（Claude Codeで壁打ち）

### 目標
Claude Codeと対話しながら、アプリの仕様を明確化する

### 手順

1. **Claude Codeに依頼**
```
支出管理アプリの仕様書をMarkdown形式で作成してください。

以下の機能が必要です：
- 日付・カテゴリ・金額の入力
- 支出一覧の表示
- 削除機能
- 合計金額の表示
- localStorageでの保存
- Googleスプレッドシートへの保存

画面は1画面完結型で、スマホでも使いやすくしてください。
```

2. **壁打ちで詳細化**
- 「カテゴリはどんな種類が必要？」
- 「削除は個別削除？全削除？」
- 「日付は手入力？カレンダー選択？」

3. **最終仕様書を確定**
- Claude Codeとの対話で固まった仕様を `仕様書.md` として保存
- データ構造、画面構成、機能一覧を明記

### 必須項目

仕様書には以下を含めること：
- [ ] アプリの目的
- [ ] 画面構成（ワイヤーフレーム的な説明）
- [ ] 機能一覧
- [ ] データ構造（localStorageとスプレッドシート）
- [ ] 入出力仕様

---

## 💻 フェーズ2：GitHubリポジトリ作成

### 手順

1. GitHubで新規リポジトリ作成
   - リポジトリ名：`expense-tracker-[あなたの名前]`
   - Public設定
   - README.mdを追加

2. ローカルにクローン
```bash
git clone https://github.com/[あなたのユーザー名]/expense-tracker-[名前].git
cd expense-tracker-[名前]
```

3. 仕様書をコミット
```bash
git add 仕様書.md
git commit -m "docs: 仕様書を作成"
git push
```

---

## 🎨 フェーズ3：フロントエンド開発

### 必須機能

| 機能 | 説明 |
|------|------|
| 入力フォーム | 日付・カテゴリ・金額を入力 |
| 追加ボタン | 入力内容を一覧に追加 |
| 一覧表示 | 登録済み支出を表示 |
| 削除ボタン | 個別の支出を削除 |
| 合計表示 | 全支出の合計金額を表示 |
| localStorage保存 | ページ再読み込みでもデータ保持 |

### ファイル構成

```
expense-tracker/
├── index.html      # メイン画面
├── style.css       # スタイル
├── main.js         # ロジック
└── 仕様書.md       # 仕様書
```

### 実装例（index.html）

```html
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>支出管理アプリ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>💰 支出管理</h1>

    <!-- 入力フォーム -->
    <div class="input-section">
      <input type="date" id="date" required>
      <select id="category">
        <option value="食費">食費</option>
        <option value="交通費">交通費</option>
        <option value="娯楽">娯楽</option>
        <option value="その他">その他</option>
      </select>
      <input type="number" id="amount" placeholder="金額" required>
      <button onclick="addExpense()">追加</button>
    </div>

    <!-- 合計表示 -->
    <div class="total">
      合計: <span id="total">0</span>円
    </div>

    <!-- 一覧表示 -->
    <div id="expenseList"></div>

    <!-- GAS連携ボタン -->
    <button class="sync-btn" onclick="syncToSheet()">📊 スプレッドシートへ保存</button>
  </div>

  <script src="main.js"></script>
</body>
</html>
```

### 実装例（main.js）

```javascript
// localStorageからデータ読み込み
let expenses = JSON.parse(localStorage.getItem('expenses')) || [];

// 初期表示
window.onload = function() {
  renderExpenses();
  updateTotal();
  // 今日の日付をデフォルト設定
  document.getElementById('date').valueAsDate = new Date();
};

// 支出追加
function addExpense() {
  const date = document.getElementById('date').value;
  const category = document.getElementById('category').value;
  const amount = parseInt(document.getElementById('amount').value);

  if (!date || !amount) {
    alert('日付と金額を入力してください');
    return;
  }

  const expense = {
    id: Date.now(),
    date: date,
    category: category,
    amount: amount
  };

  expenses.push(expense);
  saveToLocal();
  renderExpenses();
  updateTotal();

  // フォームクリア
  document.getElementById('amount').value = '';
}

// 支出削除
function deleteExpense(id) {
  expenses = expenses.filter(e => e.id !== id);
  saveToLocal();
  renderExpenses();
  updateTotal();
}

// 一覧表示
function renderExpenses() {
  const list = document.getElementById('expenseList');
  list.innerHTML = '';

  expenses.forEach(expense => {
    const item = document.createElement('div');
    item.className = 'expense-item';
    item.innerHTML = `
      <span>${expense.date}</span>
      <span class="category">${expense.category}</span>
      <span class="amount">${expense.amount.toLocaleString()}円</span>
      <button onclick="deleteExpense(${expense.id})">削除</button>
    `;
    list.appendChild(item);
  });
}

// 合計計算
function updateTotal() {
  const total = expenses.reduce((sum, e) => sum + e.amount, 0);
  document.getElementById('total').textContent = total.toLocaleString();
}

// localStorageに保存
function saveToLocal() {
  localStorage.setItem('expenses', JSON.stringify(expenses));
}

// スプレッドシートへ同期（GAS連携）
function syncToSheet() {
  // この関数はフェーズ4で実装
  alert('スプレッドシート連携は次のフェーズで実装します');
}
```

### 実装例（style.css）

```css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  padding: 20px;
}

.container {
  max-width: 600px;
  margin: 0 auto;
  background: white;
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

h1 {
  text-align: center;
  margin-bottom: 30px;
  color: #333;
}

.input-section {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr auto;
  gap: 10px;
  margin-bottom: 20px;
}

.input-section input,
.input-section select,
.input-section button {
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
}

.input-section button {
  background: #667eea;
  color: white;
  border: none;
  cursor: pointer;
  font-weight: bold;
}

.input-section button:hover {
  background: #5568d3;
}

.total {
  text-align: right;
  font-size: 24px;
  font-weight: bold;
  margin-bottom: 20px;
  color: #667eea;
}

.expense-item {
  display: grid;
  grid-template-columns: 120px 100px 1fr auto;
  gap: 10px;
  padding: 15px;
  background: #f5f5f5;
  border-radius: 8px;
  margin-bottom: 10px;
  align-items: center;
}

.category {
  background: #667eea;
  color: white;
  padding: 5px 10px;
  border-radius: 5px;
  font-size: 12px;
  text-align: center;
}

.amount {
  font-weight: bold;
  color: #333;
}

.expense-item button {
  padding: 8px 15px;
  background: #f5576c;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

.sync-btn {
  width: 100%;
  padding: 15px;
  background: #19547b;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  margin-top: 20px;
}

.sync-btn:hover {
  background: #134159;
}

@media (max-width: 600px) {
  .input-section {
    grid-template-columns: 1fr;
  }

  .expense-item {
    grid-template-columns: 1fr;
    gap: 5px;
  }
}
```

### コミット

```bash
git add index.html style.css main.js
git commit -m "feat: フロントエンド実装完了"
git push
```

---

## 📊 フェーズ4：GAS連携（スプレッドシート保存）

### 目標
Googleスプレッドシートにデータを自動保存する

### 手順

#### 1. Googleスプレッドシート作成

1. 新規スプレッドシート作成
   - ファイル名：「支出管理_[あなたの名前]」

2. **シート構造**

| A列 | B列 | C列 |
|-----|-----|-----|
| 日付 | カテゴリ | 金額 |
| 2025/10/05 | 食費 | 1200 |

#### 2. GASスクリプト作成

1. スプレッドシートのメニュー → 「拡張機能」 → 「Apps Script」

2. 以下のコードを貼り付け

```javascript
// スプレッドシートに1件追加
function saveExpense(date, category, amount) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('シート1');
  sheet.appendRow([date, category, amount]);
  return { success: true };
}

// 全データを一括保存
function saveAllExpenses(expenses) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('シート1');

  // 既存データをクリア（ヘッダー以外）
  const lastRow = sheet.getLastRow();
  if (lastRow > 1) {
    sheet.getRange(2, 1, lastRow - 1, 3).clear();
  }

  // 全データを追加
  expenses.forEach(expense => {
    sheet.appendRow([expense.date, expense.category, expense.amount]);
  });

  return { success: true, count: expenses.length };
}

// 日別合計を計算（応用）
function getDailySummary() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('シート1');
  const data = sheet.getDataRange().getValues();

  const summary = {};
  for (let i = 1; i < data.length; i++) {
    const date = data[i][0];
    const amount = data[i][2];
    summary[date] = (summary[date] || 0) + amount;
  }

  return summary;
}
```

3. **デプロイ**（重要）
   - 「デプロイ」→「新しいデプロイ」
   - 種類：**ウェブアプリ**
   - アクセス権限：**全員**
   - デプロイ
   - **ウェブアプリURL**をコピー

#### 3. HTML側の実装

`index.html` の `<head>` 内に追加：

```html
<script>
  const GAS_URL = 'ここにGASのウェブアプリURLを貼り付け';
</script>
```

`main.js` の `syncToSheet()` 関数を更新：

```javascript
// スプレッドシートへ同期
function syncToSheet() {
  if (expenses.length === 0) {
    alert('保存するデータがありません');
    return;
  }

  // GASに全データを送信
  fetch(GAS_URL, {
    method: 'POST',
    body: JSON.stringify({
      action: 'saveAll',
      expenses: expenses
    })
  })
  .then(response => response.json())
  .then(result => {
    if (result.success) {
      alert(`✅ ${result.count}件のデータを保存しました！`);
    } else {
      alert('❌ 保存に失敗しました');
    }
  })
  .catch(error => {
    alert('エラー: ' + error.message);
  });
}
```

**または、google.script.runを使う場合**（HTMLをGASで直接ホスティングする場合）

```javascript
function syncToSheet() {
  google.script.run
    .withSuccessHandler(function(result) {
      alert(`✅ ${result.count}件保存しました`);
    })
    .withFailureHandler(function(error) {
      alert('エラー: ' + error.message);
    })
    .saveAllExpenses(expenses);
}
```

#### 4. 動作確認

1. アプリで支出を3件追加
2. 「スプレッドシートへ保存」ボタンをクリック
3. スプレッドシートを確認してデータが追加されているか確認

### コミット

```bash
git add main.js
git commit -m "feat: GAS連携を実装"
git push
```

---

## 📤 フェーズ5：提出

### 提出物一覧

| ファイル | 内容 |
|---------|------|
| 仕様書.md | Claude Codeで作成した仕様書 |
| index.html | メイン画面 |
| style.css | スタイルシート |
| main.js | ロジック |
| main.gs | GASスクリプト（コピペして提出） |
| README.md | アプリ概要・セットアップ方法 |
| prompts.txt | Claude Codeに入力したプロンプト集 |
| screenshots/ | 動作確認画像（3枚以上） |

### README.md の書き方

```markdown
# 支出管理アプリ

## 概要
日々の支出を記録・管理するWebアプリです。
localStorageとGoogleスプレッドシートの両方に保存できます。

## 機能
- ✅ 日付・カテゴリ・金額の入力
- ✅ 支出一覧の表示
- ✅ 個別削除機能
- ✅ 合計金額の表示
- ✅ localStorageでの自動保存
- ✅ Googleスプレッドシートへの同期

## セットアップ

1. このリポジトリをクローン
2. `index.html` をブラウザで開く
3. GAS連携する場合：
   - Googleスプレッドシートを作成
   - GASスクリプト（main.gs）をデプロイ
   - URLを`index.html`に設定

## 使い方
1. 日付・カテゴリ・金額を入力
2. 「追加」ボタンで登録
3. 「スプレッドシートへ保存」で同期

## 技術スタック
- HTML/CSS/JavaScript
- Google Apps Script
- localStorage API
```

### prompts.txt の書き方

```
=== Claude Codeに入力したプロンプト集 ===

[フェーズ1: 仕様書作成]
プロンプト1:
「支出管理アプリの仕様書をMarkdown形式で作成してください。
日付・カテゴリ・金額を入力して一覧表示し、
localStorageとGoogleスプレッドシートに保存する機能が必要です。」

Claudeの回答:
（仕様書の内容）

プロンプト2:
「カテゴリは食費・交通費・娯楽・その他の4種類にしてください。
削除機能も追加してください。」

[フェーズ3: CSS改善]
プロンプト3:
「スマホでも見やすいようにレスポンシブデザインにしてください」

（以降、実際に使用したプロンプトを記録）
```

### スクリーンショット

以下の画面を撮影：
1. 支出入力画面
2. 一覧表示（3件以上登録した状態）
3. Googleスプレッドシート（データが保存された状態）

### 最終コミット・Push

```bash
git add README.md prompts.txt screenshots/
git commit -m "docs: 提出物を追加"
git push
```

### 課題完了報告（※課題4と同じ仕組み）

**管理者のLINEグループに報告**
```
【課題5完了報告】
研修生：[あなたの名前]
課題：支出管理アプリ

GitHubリポジトリ:
https://github.com/[ユーザー名]/expense-tracker-[名前]

確認をお願いします！
```

---

## ✅ 評価基準（100点満点）

| 項目 | 配点 | 判定基準 |
|------|------|---------|
| **機能実装** | 30点 | 仕様どおりに動作する |
| **仕様設計** | 20点 | Claude Codeとの壁打ちで明確な仕様を作成 |
| **コード品質** | 20点 | 可読性・命名・コメントの適正 |
| **AI活用力** | 10点 | プロンプトの適切さ（prompts.txt） |
| **GAS連携** | 10点 | スプレッドシートへの保存が正確 |
| **Git管理** | 10点 | コミット粒度・構成・提出形式 |

### 必須チェックリスト

- [ ] 支出の追加ができる
- [ ] 一覧表示ができる
- [ ] 削除ができる
- [ ] 合計金額が表示される
- [ ] ページ再読み込みでもデータが残る
- [ ] スプレッドシートへ保存できる
- [ ] GitHubにpushされている
- [ ] README.mdがある
- [ ] prompts.txtがある
- [ ] スクリーンショットがある

---

## 🚀 発展課題（任意・加点）

### +10点：グラフ表示
- Chart.jsを使って月別支出のグラフ表示

### +10点：自動メール送信
- GASで週次レポートを自動メール送信

### +5点：逆連携
- スプレッドシートからデータを読み込んで一覧表示

### +5点：カテゴリ別集計
- カテゴリごとの合計を表示

---

## 🚨 トラブルシューティング

| 問題 | 解決方法 |
|------|---------|
| localStorageが保存されない | ブラウザのシークレットモードではないか確認 |
| GAS連携が動かない | ウェブアプリURLが正しいか確認 |
| スプレッドシートにデータが追加されない | GASのデプロイ時に「全員」を選択したか確認 |
| CORSエラーが出る | GASはウェブアプリとしてデプロイする必要がある |

---

## 💡 重要ポイント

### Claude Codeの正しい使い方
❌ **NG**: 「支出管理アプリを全部作って」
✅ **OK**: 「localStorage周りのロジックを教えて。どう設計すべき？」

### AI活用の本質
- Claude Codeは「設計」と「改善」のパートナー
- コード生成を丸投げせず、仕様を固めることが重要
- わからない部分を具体的に質問する

### Git管理のコツ
- 機能ごとにコミット
- コミットメッセージは明確に（例：`feat: 削除機能を追加`）
- pushする前に動作確認

---

**この課題で、VEXUMが求める「AIを使いこなす実践的エンジニア思考」を身につけましょう！** 💪
