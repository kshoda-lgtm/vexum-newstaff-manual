# 管理者向けセットアップガイド

## 📋 事前準備（15分）

### 1. LINE公式アカウント作成

1. [LINE Business ID](https://account.line.biz/) にアクセス
2. アカウント作成 → ログイン
3. 「Messaging API チャネルを作成」
4. 必要事項を入力して作成

### 2. アクセストークン取得

1. 作成したチャネルを選択
2. 「Messaging API設定」タブを開く
3. 下部の「チャネルアクセストークン（長期）」で「発行」
4. **トークンをコピーして保管**（例: `AbC...xyz==`）

### 3. 研修用LINEグループ作成

1. LINEアプリで新規グループ作成
   - グループ名：「2025年度 新人研修 - 出退勤アプリ」

2. LINE公式アカウントのボットを招待
   - 作成したLINE公式アカウントを検索して追加

3. **グループID取得**（以下の手順）

---

## 🔑 グループID取得方法

### STEP 1: 一時的なGASを作成

1. 新規スプレッドシート作成（使い捨て）
2. 「拡張機能」→「Apps Script」
3. 以下のコードを貼り付け

```javascript
function doPost(e) {
  const data = JSON.parse(e.postData.contents);
  const groupId = data.events[0].source.groupId;
  SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getRange('A1').setValue(groupId);
}
```

4. 「デプロイ」→「新しいデプロイ」
   - 種類：ウェブアプリ
   - アクセス：**全員**
   - デプロイ
5. **ウェブアプリURLをコピー**

### STEP 2: Webhook設定

1. LINE Developersコンソールに戻る
2. 「Messaging API設定」タブ
3. 「Webhook URL」に、STEP 1のURLを貼り付け
4. **「Webhookの利用」をON（緑色）**
5. 「検証」ボタンで確認

### STEP 3: グループIDを取得

1. 研修用LINEグループで適当なメッセージを1つ送信
2. STEP 1のスプレッドシートを開く
3. A1セルに表示された文字列（`C0123...`）が**グループID**
4. **グループIDをコピーして保管**

### STEP 4: 後片付け

1. LINE Developersで「Webhookの利用」を**OFF**
2. 使い捨てスプレッドシートは削除してOK

---

## 📤 研修生への配布

### 配布する情報

研修生に以下の2つを伝えてください：

```
【研修生への連絡】

以下の情報を使ってアプリを開発してください。

1. LINE チャネルアクセストークン
   AbC...xyz==

2. LINE グループID
   C0123456789abcdef0123456789abcdef

3. 研修生マスタへの登録
   - あなたの研修生ID（例：user01）
   - 氏名

を以下のスプレッドシートに追加してください：
https://docs.google.com/spreadsheets/d/xxxxx
```

### 研修生マスタの準備

共有用のスプレッドシートを用意するか、各自で作成させる

**共有する場合：**
1. マスタースプレッドシート作成
2. 「研修生マスタ」シートに全員分のIDを事前登録
3. 編集権限を研修生に付与

**各自作成の場合：**
- 研修生が自分でスプレッドシート作成
- 自分のIDのみ登録

---

## 🔔 通知の受け取り方

### 出勤通知
```
【出勤】
田中太郎
2025/10/05 09:05
```

### 退勤通知
```
【退勤】
田中太郎
出勤：09:05
退勤：18:10
勤務：9時間5分
```

### 課題完了通知 ⭐重要⭐
```
【🎉課題完了報告🎉】
研修生：田中太郎（user01）
完了：2025/10/05 15:30

アプリURL:
https://tanaka01.github.io/attendance-app

確認をお願いします！
```

---

## ✅ 合格判定の流れ

### 1. 課題完了通知を受信

### 2. アプリURLにアクセスして確認

- [ ] 出勤ボタンが動作する
- [ ] 退勤ボタンが動作する
- [ ] LINE通知が届く
- [ ] 勤務時間が正しく計算される
- [ ] PWAとしてインストールできる

### 3. スプレッドシートで判定記録

研修生のスプレッドシート「課題完了記録」シートで：
- 「確認待ち」→「**合格**」に変更

### 4. 研修生に通知

LINEで個別に連絡：
```
@田中太郎
課題合格です！🎉
次のステップに進んでください。
```

---

## 📊 進捗管理

### ダッシュボード作成（オプション）

全研修生の進捗を一覧管理するスプレッドシートを作成：

| 研修生ID | 氏名 | 完了日時 | 判定 | 備考 |
|---------|------|---------|------|------|
| user01 | 田中太郎 | 10/05 15:30 | 合格 | デザイン良 |
| user02 | 佐藤花子 | 10/06 10:00 | 合格 | - |
| user03 | 鈴木一郎 | - | 進行中 | - |

---

## 🚨 トラブル対応

### 通知が届かない
1. トークンが正しいか確認
2. グループIDが正しいか確認
3. 研修生のGAS URLが正しいか確認

### 研修生が詰まっている
1. エラーメッセージを確認させる
2. GASのログを確認させる
3. スプレッドシートのシート名を確認

### 複数人から同時に通知
- 通知は全員分届きます
- 順番に確認してOK

---

## 💡 運営のコツ

### 1. 最初の1人を手厚くサポート
- 最初の合格者が出ると他も追随

### 2. 良い実装を共有
- 優秀な実装例をグループで共有
- 「参考にしてOK」と伝える

### 3. ランキング発表
- 完了順位を発表
- 実装品質で表彰

### 4. 相互レビュー
- 研修生同士でアプリを試させる
- フィードバックし合う

---

**研修を成功させましょう！ 💪**
